From e9b80e4fa3b535e86bf863f62686fe7cd8d508b2 Mon Sep 17 00:00:00 2001
From: Sameer Rahmani <lxsameer@gnu.org>
Date: Mon, 25 Sep 2017 15:29:54 +0100
Subject: [PATCH] CLJS-2166: Add uri? predicate

Clojure introduced a `uri?` predicate in 1.9. This commit adds support for `uri`
to Clojurescript under `cljs.core/uri?`. It returns true if the given argument
is an instance of `goog.Uri`, false otherwise.
---
 src/main/cljs/cljs/core.cljs      | 9  ++++++++-
 src/test/cljs/cljs/core_test.cljs | 10 ++++++++++
 2 files changed, 29 insertions(+), 12 deletions(-)

diff --git a/src/main/cljs/cljs/core.cljs b/src/main/cljs/cljs/core.cljs
index 519e4ab0..47fee676 100644
--- a/src/main/cljs/cljs/core.cljs
+++ b/src/main/cljs/cljs/core.cljs
@@ -11,7 +11,8 @@
             goog.math.Integer
             [goog.string :as gstring]
             [goog.object :as gobject]
-            [goog.array :as garray])
+            [goog.array :as garray]
+            [goog.Uri])
   (:import [goog.string StringBuffer]))
 
 ;; next line is auto-generated by the build-script - Do not edit!
@@ -11168,3 +11169,9 @@ reduces them without incurring seq initialization"
   Bootstrap only."
   [ns-obj]
   (.-name ns-obj))
+
+(defn uri?
+  "Returns true X is a goog.Uri instance."
+  {:added "1.9"}
+  [x]
+  (instance? goog.Uri x))
diff --git a/src/test/cljs/cljs/core_test.cljs b/src/test/cljs/cljs/core_test.cljs
index f2d7b065..06fe265a 100644
--- a/src/test/cljs/cljs/core_test.cljs
+++ b/src/test/cljs/cljs/core_test.cljs
@@ -1493,3 +1493,13 @@
   ;;   (assert (= (:arglists var-meta) '([a b]))))
 
   )
+
+(deftest uri-predicate
+  (testing "Testing uri?"
+    (is (not (uri? "http://clojurescript.org")))
+    (is (not (uri? 42)))
+    (is (not (uri? [])))
+    (is (not (uri? {})))
+    (is (uri? (goog.Uri. "")))
+    (is (uri? (goog.Uri. "http://clojurescript.org")))
+    (is (uri? (goog.Uri. "some string")))))
-- 
2.11.0

